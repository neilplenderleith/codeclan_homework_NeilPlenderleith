library(tidyverse)
cardbase <- read_csv("../data/CardBase.csv")
customer_base <- read_csv("../data/CustomerBase.csv")
fraud_base <- read_csv("../data/FraudBase.csv")
transaction_base <- read_csv("../data/TransactionBase.csv")
View(cardbase)
View(customer_base)
View(fraud_base)
View(transaction_base)
View(customer_base)
View(cardbase)
View(customer_base)
View(fraud_base)
View(transaction_base)
View(customer_base)
View(cardbase)
card_base <- read_csv("../data/CardBase.csv")
customer_base <- read_csv("../data/CustomerBase.csv")
fraud_base <- read_csv("../data/FraudBase.csv")
transaction_base <- read_csv("../data/TransactionBase.csv")
left_join(card_base, customer_base)
full_join(fraud_base, transaction_base)
View(fraud_base)
View(fraud_base)
View(transaction_base)
full_join(fraud_base, transaction_base) %>%
unique(Transaction_ID)
full_join(fraud_base, transaction_base)
View(transaction_base)
View(fraud_base)
View(transaction_base)
View(fraud_base)
full_join(transaction_base, fraud_base)
full_join(transaction_base, fraud_base) %>%
unique(Transaction_ID)
full_join(transaction_base, fraud_base)
# row number is 10000, the size of transaction data. As fraud data is only 109 rows these all must match a row in transaction data. Quick look at the data shows this to be true and it makes sense - a small fraction of transactions would be flagged for fraud purposes.
card_base
transaction_base
semi_join(card_base, transaction_base)
card_base
library(janitor)
clean_names(c(card_base, customer_base, fraud_base, transaction_base))
clean_names(c("card_base", "customer_base", "fraud_base", "transaction_base"))
clean_names(c("card_base"))
clean_names(card_base)
card_base <- read_csv("../data/CardBase.csv")
customer_base <- read_csv("../data/CustomerBase.csv")
fraud_base <- read_csv("../data/FraudBase.csv")
transaction_base <- read_csv("../data/TransactionBase.csv")
clean_names(card_base)
clean_names(customer_base)
clean_names(fraud_base)
clean_names(transaction_base)
card_base
clean_names(card_base, case = "snake")
card_base <- read_csv("../data/CardBase.csv")
customer_base <- read_csv("../data/CustomerBase.csv")
fraud_base <- read_csv("../data/FraudBase.csv")
transaction_base <- read_csv("../data/TransactionBase.csv")
clean_names(card_base, case = "snake")
clean_names(customer_base, case = "snake")
clean_names(fraud_base, case = "snake")
clean_names(transaction_base, case = "snake")
library(tidyverse)
library(janitor)
card_base <- read_csv("../data/CardBase.csv")
customer_base <- read_csv("../data/CustomerBase.csv")
fraud_base <- read_csv("../data/FraudBase.csv")
transaction_base <- read_csv("../data/TransactionBase.csv")
clean_names(card_base, case = "snake")
clean_names(customer_base, case = "snake")
clean_names(fraud_base, case = "snake")
clean_names(transaction_base, case = "snake")
left_join(card_base, customer_base)
# expected it to return 500 rows - the size of card data(card_base)
full_join(transaction_base, fraud_base)
# row number is 10000, the size of transaction data. As fraud data is only 109 rows these all must match a row in transaction data. Quick look at the data shows this to be true and it makes sense - a small fraction of transactions would be flagged for fraud purposes.
card_base
card_base
card_base <- read_csv("../data/CardBase.csv")
customer_base <- read_csv("../data/CustomerBase.csv")
fraud_base <- read_csv("../data/FraudBase.csv")
transaction_base <- read_csv("../data/TransactionBase.csv")
card_base <- clean_names(card_base, case = "snake")
customer_base <-clean_names(customer_base, case = "snake")
fraud_base <- clean_names(fraud_base, case = "snake")
transaction_base <-(transaction_base, case = "snake")
card_base <- read_csv("../data/CardBase.csv")
customer_base <- read_csv("../data/CustomerBase.csv")
fraud_base <- read_csv("../data/FraudBase.csv")
transaction_base <- read_csv("../data/TransactionBase.csv")
card_base <- clean_names(card_base, case = "snake")
customer_base <-clean_names(customer_base, case = "snake")
fraud_base <- clean_names(fraud_base, case = "snake")
transaction_base <- clean_names(transaction_base, case = "snake")
library(tidyverse)
library(janitor)
card_base <- read_csv("../data/CardBase.csv")
customer_base <- read_csv("../data/CustomerBase.csv")
fraud_base <- read_csv("../data/FraudBase.csv")
transaction_base <- read_csv("../data/TransactionBase.csv")
card_base <- clean_names(card_base, case = "snake")
customer_base <-clean_names(customer_base, case = "snake")
fraud_base <- clean_names(fraud_base, case = "snake")
transaction_base <- clean_names(transaction_base, case = "snake")
left_join(card_base, customer_base)
# expected it to return 500 rows - the size of card data(card_base)
full_join(transaction_base, fraud_base)
# row number is 10000, the size of transaction data. As fraud data is only 109 rows these all must match a row in transaction data. Quick look at the data shows this to be true and it makes sense - a small fraction of transactions would be flagged for fraud purposes.
card_base
transaction_base
semi_join(card_base, transaction_base, by = c("card_number" = "credit_card_id"))
# semi_join(card_base, transaction_base, by = c("card_number" = "credit_card_id"))
semi_join(transaction_base, card_base,  by = c("credit_card_id" = "card_number"))
transaction_base %>%
unique(credit_card_id)
transaction_base
transaction_base %>%
count(credit_card_id)
hat_observations <- read_csv("../data/hat_observations.csv")
hat_observations
hat_observations %>%
separate(observation, c("hat_colour", "hat_type"), sep = ",")
hat_observations %>%
separate(observation, c("hat_colour", "hat_type"), sep = ",") %>%
unite(date, c("day", "month", "year"), sep = ":")
hat_observations %>%
separate(observation, c("hat_colour", "hat_type"), sep = ",") %>%
unite(date, c("day", "month", "year"), sep = ":") %>%
slice_max(observation_count, n = 1)
hat_observations %>%
separate(observation, c("hat_colour", "hat_type"), sep = ",") %>%
unite(date, c("day", "month", "year"), sep = ":") %>%
slice_max(observation_count, n = 1) %>%
pull(date)
View(card_base)
left_join(card_base, customer_base)
left_join(card_base, customer_base) %>%
left_join(transaction_base, by = c("card_number" = "credit_card_id"))
left_join(card_base, customer_base) %>%
left_join(transaction_base, by = c("card_number" = "credit_card_id")) %>%
semi_join(fraud_base)
left_join(card_base, customer_base) %>%
left_join(transaction_base, by = c("card_number" = "credit_card_id")) %>%
right_join(fraud_base)
exam_scores <- read_csv("../data/exam_scores.csv")
exam_scores
exam_scores %>%
pivot_longer(cols = starts_with("exam"),
names_to = "exam_question",
values_to = "score")
exam_scores %>%
pivot_longer(cols = starts_with("exam"),
names_to = "exam_question",
values_to = "score") %>%
separate(col = exam_question, c("exam", "exam_question"), sep = "_" )
exam_scores %>%
pivot_longer(cols = starts_with("exam"),
names_to = "exam_question",
values_to = "score") %>%
separate(col = exam_question, c("exam", "exam_question"), sep = "_" ) %>%
select(id, exam_question, score)
# not clear hich way round you want it joined, pretty muh just returns the whole dataset either way???
# semi_join(card_base, transaction_base, by = c("card_number" = "credit_card_id"))
semi_join(transaction_base, card_base,  by = c("credit_card_id" = "card_number"))
# not clear which way round you want it joined, pretty much just returns the whole dataset either way???
# maybe im not understanding the question
semi_join(card_base, transaction_base, by = c("card_number" = "credit_card_id"))
# semi_join(transaction_base, card_base,  by = c("credit_card_id" = "card_number"))
hat_observations %>%
separate(observation, c("hat_colour", "hat_type"), sep = ",") %>%
unite(date, c("day", "month", "year"), sep = ":") %>%
filter(hat_type == "beret") %>%
slice_max(observation_count, n = 1) %>%
pull(date)
hat_observations
hat_observations %>%
separate(observation, c("hat_colour", "hat_type"), sep = ",") %>%
unite(date, c("day", "month", "year"), sep = ":") %>%
filter(hat_type == "beret") %>%
slice_max(observation_count, n = 1)
library(tidyverse)
library(janitor)
card_base <- read_csv("../data/CardBase.csv")
customer_base <- read_csv("../data/CustomerBase.csv")
fraud_base <- read_csv("../data/FraudBase.csv")
transaction_base <- read_csv("../data/TransactionBase.csv")
# following cleans up the column names with _ and lower case
card_base <- clean_names(card_base, case = "snake")
customer_base <-clean_names(customer_base, case = "snake")
fraud_base <- clean_names(fraud_base, case = "snake")
transaction_base <- clean_names(transaction_base, case = "snake")
left_join(card_base, customer_base)
# expected it to return 500 rows - the size of card data(card_base)
full_join(transaction_base, fraud_base)
# row number is 10000, the size of transaction data. As fraud data is only 109 rows
# these all must match a row in transaction data. Quick look at the data shows this
# to be true and it makes sense - a small fraction of transactions would be flagged
# for fraud purposes.
card_base
transaction_base
card_base
customer_base
View(card_base)
# not clear which way round you want it joined, pretty much just returns the whole dataset either way???
# maybe i'm not understanding the question
semi_join(card_base, transaction_base, by = c("card_number" = "credit_card_id"))
# semi_join(transaction_base, card_base,  by = c("credit_card_id" = "card_number"))
# I've tried it both ways and either way it simply returns the whole dataset on the left
# of the join argument. this does show that all credit cards have at least one transaction
# and also all the credit cards in the transaction dataset are in the credit card dataset
card_base
