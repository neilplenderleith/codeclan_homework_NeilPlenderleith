group_by(year_written)
books_date
books_date <- books_clean %>%
mutate(pub_date = anydate(publication_date), year_written = year(pub_date)) %>%
group_by(year_written)
books_date
books_date <- books_clean %>%
mutate(pub_date = anydate(publication_date), year_written = year(pub_date)) %>%
group_by(year_written) %>%
summarise(rating_per_year = mean(average_rating))
books_date
books_date <- books_clean %>%
mutate(pub_date = anydate(publication_date), year_written = year(pub_date)) %>%
group_by(year_written) %>%
summarise(rating_per_year = mean(average_rating), no_ratings_per_year = n())
books_date
View(books_date)
books_date <- books_clean %>%
mutate(pub_date = anydate(publication_date), year_written = year(pub_date)) %>%
group_by(year_written) %>%
summarise(rating_per_year = mean(average_rating), no_ratings_per_year = n())
filter(no_ratings_per_year >= 5)
books_date <- books_clean %>%
mutate(pub_date = anydate(publication_date), year_written = year(pub_date)) %>%
group_by(year_written) %>%
summarise(rating_per_year = mean(average_rating), no_ratings_per_year = n()) %>%
filter(no_ratings_per_year >= 5) %>%
slice_max(rating_per_year, n = 10)
books_date
languages_percent <- books_clean %>%
count(language_code) %>%
arrange(desc(n)) %>%
mutate(percentage_language = round((n/sum(n))*100, 2)) %>%
slice_max(percentage_language, n = 10) %>%
select(language_code, percentage_language)
languages_percent
library(tidyverse)
library(skimr)
library(janitor)
library(lubridate)
library(anytime)
books <- read.csv("books.csv")
#I used these 3 functions to get an initial idea of the dataset
# glimpse(books)
# summary(books)
# skim(books)
# Lets do a count of N/A and missing values etc
books %>%
summarise(across(.fns = ~ sum(is.na(.x))))
# this counts N/A values across all columns
books %>%
summarise(across(.fns = ~ sum(is_empty(.x))))
# this counts empty values in columns
books %>%
summarise(across(.fns = ~ sum(.x == "")))
# This counts empty strings across all columns
books %>%
summarise(across(.fns = ~ sum(.x == 0,
na.rm = T)))
#This counts any 0 values across all columns
# here we drop NA's, clean out a couple of randowm rows
# swap numpages for integer from character
# swap avergae rating to numeric
# impute into num_pages the mean of num_pages column for 0 values
books_clean <- books %>%
drop_na() %>% # Lets drop the 4 N/A rows
filter(!num_pages %in% c("eng", "en-US")) %>%
mutate(num_pages = as.integer(num_pages),
average_rating = as.numeric(average_rating)) %>%
mutate(num_pages = if_else(num_pages == 0,
as.integer(mean(num_pages)),
num_pages))
books_clean %>%  # quick check to see "0"s have gone (changed to mean)
summarise(across(.cols = num_pages, .fns = ~ sum(.x == 0,
na.rm = T)))
books_clean %>%
group_by(authors) %>%
summarise(books_authored = n()) %>%
slice_max(books_authored, n = 10)
top_10_reviewed_authors <- books_clean %>%
group_by(authors) %>%
summarise(books_authored = n(),
author_average_reviews = round(mean(average_rating), 2)) %>%
filter(books_authored > 10) %>%
slice_max(author_average_reviews, n = 10) %>%
select(authors, author_average_reviews)
top_10_reviewed_authors
languages_percent <- books_clean %>%
count(language_code) %>%
arrange(desc(n)) %>%
mutate(percentage_language = round((n/sum(n))*100, 2)) %>%
slice_max(percentage_language, n = 10) %>%
select(language_code, percentage_language)
languages_percent
books_date <- books_clean %>%
mutate(pub_date = anydate(publication_date), year_written = year(pub_date)) %>%
group_by(year_written) %>%
summarise(rating_per_year = mean(average_rating), no_ratings_per_year = n()) %>%
filter(no_ratings_per_year >= 5) %>%
slice_max(rating_per_year, n = 10)
books_date
View(books_clean)
books_clean %>%
filter(authors %in% "/")
books_clean %>%
filter("/" %in% authors)
books_clean %>%
grep("/", authors)
books_clean %>%
grep("/", pull(authors))
books_clean %>%
grep("/", pull(books_clean$authors))
books_clean %>%
grep("/", books_clean$authors)
books_clean %>%
grepl("/", books_clean$authors)
books_clean %>%
grepl("/", books_clean$authors, fixed = T)
books_clean %>%
summarise(multi_author = grepl("/", books_clean$authors, fixed = T))
books_clean %>%
summarise(multi_author = grep("/", books_clean$authors, fixed = T))
group_by(authors) %>%
summarise(multi_author = )
books_clean %>%
summarise(multi_author = grepl("/", books_clean$authors, fixed = T))
group_by(authors) %>%
summarise(multi_author = )
books_clean %>%
summarise(multi_author = grep("/", books_clean$authors, fixed = T))
books_clean %>%
summarise(multi_author = grepl("/", books_clean$authors, fixed = T))
group_by(authors) %>%
summarise(multi_author = )
books_clean %>%
summarise(multi_author = grepl("/", books_clean$authors, fixed = T))
Count(multi_author)
count(multi_author)
books_clean %>%
summarise(multi_author = grepl("/", books_clean$authors, fixed = T)) %>%
count(multi_author)
group_by(authors) %>%
summarise(multi_author = )
books_clean %>%
summarise(multi_author = grepl("/", books_clean$authors, fixed = T)) %>%
count(multi_author)
mutate(multi_authored = if_else(F, "solo", "multiple authors")
books_clean %>%
books_clean %>%
summarise(multi_author = grepl("/", books_clean$authors, fixed = T)) %>%
count(multi_author) %>%
mutate(multi_authored = if_else(F, "solo", "multiple authors"))
books_clean
book_solo_yn <- books_clean %>%
summarise(multi_author = grepl("/", books_clean$authors, fixed = T)) %>%
count(multi_author) %>%
mutate(multi_authored = if_else(F, "solo", "multiple authors"))
book_solo_yn <- books_clean %>%
summarise(multi_author = grepl("/", books_clean$authors, fixed = T)) %>%
count(multi_author) %>%
mutate(multi_authored = if_else(F, "solo", "multiple authors"))
book_solo_yn
book_solo_yn <- books_clean %>%
summarise(multi_author = grepl("/", books_clean$authors, fixed = T)) %>%
count(multi_author) %>%
mutate(multi_authored = if_else(multi_authore == F, "solo", "multiple authors"))
book_solo_yn <- books_clean %>%
summarise(multi_author = grepl("/", books_clean$authors, fixed = T)) %>%
count(multi_author) %>%
mutate(multi_authored = if_else(multi_author == F, "solo", "multiple authors"))
book_solo_yn
book_solo_yn <- books_clean %>%
summarise(multi_author = grepl("/", books_clean$authors, fixed = T)) %>%
count(multi_author) %>%
mutate(multi_authored = if_else(multi_author == F, "solo", "multiple authors"), .keep = "unused")
book_solo_yn
View(books_date)
books_date <- books_clean %>%
books_with_date <- mutate(pub_date = anydate(publication_date), year_written = year(pub_date)) %>%
group_by(year_written) %>%
summarise(rating_per_year = mean(average_rating), no_ratings_per_year = n()) %>%
filter(no_ratings_per_year >= 5) %>%
slice_max(rating_per_year, n = 10)
books_date <- books_clean %>%
mutate(pub_date = anydate(publication_date), year_written = year(pub_date)) %>%
group_by(year_written) %>%
summarise(rating_per_year = mean(average_rating), no_ratings_per_year = n()) %>%
filter(no_ratings_per_year >= 5) %>%
slice_max(rating_per_year, n = 10)
books_date
books_clean %>%
select(authors, publisher)
group_by(authors) %>%
books_clean %>%
select(authors, publisher) %>%
group_by(authors)
books_clean %>%
select(authors, publisher) %>%
group_by(authors) %>%
distinct()
books_clean %>%
select(authors, publisher) %>%
group_by(authors) %>%
books_clean %>%
select(authors, publisher) %>%
group_by(authors)
books_clean %>%
select(authors, publisher) %>%
group_by(authors)
books_clean %>%
unique() %>%
group_by(authors) %>%
summarize(vis_count = n())
#   select(authors, publisher) %>%
#   group_by(authors) %>%
# distinct()
#
books_clean %>%
group_by(authors, publisher) %>%
summarise()
# unique() %>%
# group_by(authors) %>%
# summarize(vis_count = n())
#   select(authors, publisher) %>%
#   group_by(authors) %>%
# distinct()
#
books_clean %>%
group_by(authors, publisher) %>%
summarise(publisher_count = sum(n))
books_clean %>%
group_by(authors, publisher) %>%
summarise(publisher_count = sum(publisher))
summarise(publisher_count = sum(n())
books_clean %>%
books_clean %>%
group_by(authors, publisher) %>%
summarise(publisher_count = sum(n()))
# unique() %>%
# group_by(authors) %>%
# summarize(vis_count = n())
#   select(authors, publisher) %>%
#   group_by(authors) %>%
# distinct()
#
books_date <- books_clean %>%
mutate(pub_date = anydate(publication_date), year_written = year(pub_date)) %>%
group_by(year_written) %>%
summarise(rating_per_year = mean(average_rating), no_ratings_per_year = n()) %>%
filter(no_ratings_per_year >= 5) %>%
ggplot2::ggplot() +
geom_line(aes(y = year_written, x = rating_pre_year))
books_date <- books_clean %>%
mutate(pub_date = anydate(publication_date), year_written = year(pub_date)) %>%
group_by(year_written) %>%
summarise(rating_per_year = mean(average_rating), no_ratings_per_year = n()) %>%
filter(no_ratings_per_year >= 5) %>%
ggplot() +
geom_line(aes(y = year_written, x = rating_pre_year))
library(ggplot2)
books_date <- books_clean %>%
mutate(pub_date = anydate(publication_date), year_written = year(pub_date)) %>%
group_by(year_written) %>%
summarise(rating_per_year = mean(average_rating), no_ratings_per_year = n()) %>%
filter(no_ratings_per_year >= 5) %>%
ungroup() %>%
ggplot() +
geom_line(aes(y = year_written, x = rating_pre_year))
books_date <- books_clean %>%
mutate(pub_date = anydate(publication_date), year_written = year(pub_date)) %>%
group_by(year_written) %>%
summarise(rating_per_year = mean(average_rating), no_ratings_per_year = n()) %>%
filter(no_ratings_per_year >= 5) %>%
ungroup()
books_date <- books_clean %>%
mutate(pub_date = anydate(publication_date), year_written = year(pub_date)) %>%
group_by(year_written) %>%
summarise(rating_per_year = mean(average_rating), no_ratings_per_year = n()) %>%
filter(no_ratings_per_year >= 5) %>%
ungroup() %>%
qplot(x = year_written, y = rating_per_year)
books_date <- books_clean %>%
mutate(pub_date = anydate(publication_date), year_written = year(pub_date)) %>%
group_by(year_written) %>%
summarise(rating_per_year = mean(average_rating), no_ratings_per_year = n()) %>%
filter(no_ratings_per_year >= 5) %>%
ungroup() %>%
qplot(x = year_written, y = rating_per_year, data = books_date)
books_date
books_date <- books_clean %>%
mutate(pub_date = anydate(publication_date), year_written = year(pub_date)) %>%
group_by(year_written) %>%
summarise(rating_per_year = mean(average_rating), no_ratings_per_year = n()) %>%
filter(no_ratings_per_year >= 5) %>%
ungroup()
books_date
qplot(x = year_written, y = rating_per_year, data = books_date)
qplot(x = year_written, y = rating_per_year, data = books_date, geom = "path")
books_date <- books_clean %>%
mutate(pub_date = anydate(publication_date), year_written = year(pub_date)) %>%
group_by(year_written) %>%
summarise(rating_per_year = mean(average_rating), no_ratings_per_year = n()) %>%
filter(no_ratings_per_year >= 3) %>%
ungroup()
books_date
ggplot(books_date, aes(x = year_written, y = rating_per_year))
ggplot(books_date, aes(x = year_written, y = rating_per_year)) +
geom_point()
ggplot(books_date, aes(x = year_written, y = rating_per_year)) +
geom_point() +
geom_smooth()
books_date <- books_clean %>%
mutate(pub_date = anydate(publication_date), year_written = year(pub_date)) %>%
group_by(year_written) %>%
summarise(rating_per_year = mean(average_rating), no_ratings_per_year = n()) %>%
filter(no_ratings_per_year >= 4) %>%
ungroup()
ggplot(books_date, aes(x = year_written, y = rating_per_year)) +
geom_point() +
geom_smooth()
# slice_max(rating_per_year, n = 10)
books_date
books_date <- books_clean %>%
mutate(pub_date = anydate(publication_date), year_written = year(pub_date)) %>%
group_by(year_written) %>%
summarise(rating_per_year = mean(average_rating), no_ratings_per_year = n()) %>%
filter(no_ratings_per_year >= 4) %>%
slice_max(rating_per_year, n = 10)
books_date
books_date
books_date <- books_clean %>%
mutate(pub_date = anydate(publication_date), year_written = year(pub_date)) %>%
group_by(year_written) %>%
summarise(rating_per_year = mean(average_rating), no_ratings_per_year = n()) %>%
filter(no_ratings_per_year >= 4) %>%
slice_max(rating_per_year, n = 10)
books_date
books_date <- books_clean %>%
mutate(pub_date = anydate(publication_date), year_written = year(pub_date)) %>%
group_by(year_written) %>%
summarise(rating_per_year = round(mean(average_rating), 2), no_ratings_per_year = n()) %>%
filter(no_ratings_per_year >= 4) %>%
slice_max(rating_per_year, n = 10)
books_date
top_10_pubishers <- books_clean %>%
group_by(publisher) %>%
summarise(books_by_publisher = n(),
publisher_average_reviews = round(mean(average_rating), 2))
top_10_pubishers <- books_clean %>%
group_by(publisher) %>%
summarise(books_by_publisher = n(),
publisher_average_reviews = round(mean(average_rating), 2))
top_10_pubishers
# filter(books_authored > 10) %>%
#slice_max(author_average_reviews, n = 10) %>%
#select(authors, author_average_reviews)
arrange(publisher_average_reviews)
top_10_pubishers <- books_clean %>%
group_by(publisher) %>%
summarise(books_by_publisher = n(),
publisher_average_reviews = round(mean(average_rating), 2)) %>%
arrange(publisher_average_reviews)
top_10_pubishers
top_10_publishers <- books_clean %>%
group_by(publisher) %>%
summarise(books_by_publisher = n(),
publisher_average_reviews = round(mean(average_rating), 2)) %>%
arrange(desc(publisher_average_reviews)
top_10_publishers
top_10_publishers <- books_clean %>%
group_by(publisher) %>%
summarise(books_by_publisher = n(),
publisher_average_reviews = round(mean(average_rating), 2)) %>%
arrange(desc(publisher_average_reviews))
top_10_publishers
top_10_publishers <- books_clean %>%
group_by(publisher) %>%
summarise(books_by_publisher = n(),
publisher_average_reviews = round(mean(average_rating), 2)) %>%
filter(books_by_publisher > 3)
arrange(desc(publisher_average_reviews))
top_10_publishers <- books_clean %>%
group_by(publisher) %>%
summarise(books_by_publisher = n(),
publisher_average_reviews = round(mean(average_rating), 2)) %>%
filter(books_by_publisher > 3) %>%
arrange(desc(publisher_average_reviews))
top_10_publishers
# filter(books_authored > 10) %>%
#slice_max(author_average_reviews, n = 10) %>%
#select(authors, author_average_reviews)
top_10_publishers <- books_clean %>%
group_by(publisher) %>%
summarise(books_by_publisher = n(),
publisher_average_reviews = round(mean(average_rating), 2)) %>%
filter(books_by_publisher > 3) %>%
#arrange(desc(publisher_average_reviews))
arrange(desc(books_by_publisher))
top_10_publishers
# filter(books_authored > 10) %>%
#slice_max(author_average_reviews, n = 10) %>%
#select(authors, author_average_reviews)
books_date <- books_clean %>%
mutate(pub_date = anydate(publication_date), year_written = year(pub_date)) %>%
group_by(year_written) %>%
summarise(rating_per_year = round(mean(average_rating), 2), no_ratings_per_year = n()) %>%
filter(no_ratings_per_year >= 4) %>%
slice_max(rating_per_year, n = 10)
books_date
# ungroup()
#  ggplot(books_date, aes(x = year_written, y = rating_per_year)) +
#   geom_point() +
#   geom_smooth()
library(tidyverse)
library(skimr)
library(janitor)
library(lubridate)
library(anytime)
library(ggplot2)
books <- read.csv("books.csv")
#I used these 3 functions to get an initial idea of the dataset
# glimpse(books)
# summary(books)
# skim(books)
# Lets do a count of N/A and missing values etc
books %>%
summarise(across(.fns = ~ sum(is.na(.x))))
# this counts N/A values across all columns
books %>%
summarise(across(.fns = ~ sum(is_empty(.x))))
# this counts empty values in columns
books %>%
summarise(across(.fns = ~ sum(.x == "")))
# This counts empty strings across all columns
books %>%
summarise(across(.fns = ~ sum(.x == 0,
na.rm = T)))
#This counts any 0 values across all columns
# here we drop NA's, clean out a couple of random rows
# change numpages to integer from character
# change average rating to numeric
# impute into num_pages the mean of num_pages column for 0 values
books_clean <- books %>%
drop_na() %>% # Lets drop the 4 N/A rows
filter(!num_pages %in% c("eng", "en-US")) %>%
mutate(num_pages = as.integer(num_pages),
average_rating = as.numeric(average_rating)) %>%
mutate(num_pages = if_else(num_pages == 0,
as.integer(mean(num_pages)),
num_pages))
books_clean %>%  # quick check to see "0"s have gone (changed to mean)
summarise(across(.cols = num_pages, .fns = ~ sum(.x == 0,
na.rm = T)))
books_clean %>%
group_by(authors) %>%
summarise(books_authored = n()) %>%
slice_max(books_authored, n = 10)
# Turns out it returns a top-13 as the 10th place is tied 4 ways
# We will allow this but could change it with the "with_ties" argument
top_10_reviewed_authors <- books_clean %>%
group_by(authors) %>%
summarise(books_authored = n(),
author_average_reviews = round(mean(average_rating), 2)) %>%
filter(books_authored > 10) %>%
slice_max(author_average_reviews, n = 10) %>%
select(authors, author_average_reviews)
top_10_reviewed_authors
languages_percent <- books_clean %>%
count(language_code) %>%
arrange(desc(n)) %>%
mutate(percentage_language = round((n/sum(n))*100, 2)) %>%
slice_max(percentage_language, n = 10) %>%
select(language_code, percentage_language)
languages_percent
books_date <- books_clean %>%
mutate(pub_date = anydate(publication_date), year_written = year(pub_date)) %>%
group_by(year_written) %>%
summarise(rating_per_year = round(mean(average_rating), 2), no_ratings_per_year = n()) %>%
filter(no_ratings_per_year >= 4) %>%
slice_max(rating_per_year, n = 10)
books_date
# ungroup()
#  ggplot(books_date, aes(x = year_written, y = rating_per_year)) +
#   geom_point() +
#   geom_smooth()
book_solo_yn <- books_clean %>%
summarise(multi_author = grepl("/", books_clean$authors, fixed = T)) %>%
count(multi_author) %>%
mutate(multi_authored = if_else(multi_author == F, "solo", "multiple authors"), .keep = "unused")
book_solo_yn
top_10_publishers <- books_clean %>%
group_by(publisher) %>%
summarise(books_by_publisher = n(),
publisher_average_reviews = round(mean(average_rating), 2)) %>%
filter(books_by_publisher > 3) %>%
#arrange(desc(publisher_average_reviews))
arrange(desc(books_by_publisher))
top_10_publishers
# filter(books_authored > 10) %>%
#slice_max(author_average_reviews, n = 10) %>%
#select(authors, author_average_reviews)
books_clean %>%
group_by(authors, publisher) %>%
summarise(publisher_count = sum(n()))
# unique() %>%
# group_by(authors) %>%
# summarize(vis_count = n())
#   select(authors, publisher) %>%
#   group_by(authors) %>%
# distinct()
#
View(books_clean)
